{"ast":null,"code":"import{useLoaderData}from\"react-router-dom\";import{toast}from\"react-toastify\";import AddExpenseForm from\"../components/AddExpenseForm\";import BudgetItem from\"../components/BudgetItem\";import Table from\"../components/Table\";import{createExpense,deleteItem,getAllMatchingItems}from\"../helpers\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export async function budgetLoader(_ref){let{params}=_ref;const budget=await getAllMatchingItems({category:\"budgets\",key:\"id\",value:params.id})[0];const expenses=await getAllMatchingItems({category:\"expenses\",key:\"budgetId\",value:params.id});if(!budget){throw new Error(\"The budget you're trying to find doesn't exist\");}return{budget,expenses};}// action\nexport async function budgetAction(_ref2){let{request}=_ref2;const data=await request.formData();const{_action,...values}=Object.fromEntries(data);if(_action===\"createExpense\"){try{createExpense({name:values.newExpense,amount:values.newExpenseAmount,budgetId:values.newExpenseBudget});return toast.success(\"Expense \".concat(values.newExpense,\" created!\"));}catch(e){throw new Error(\"There was a problem creating your expense.\");}}if(_action===\"deleteExpense\"){try{deleteItem({key:\"expenses\",id:values.expenseId});return toast.success(\"Expense deleted!\");}catch(e){throw new Error(\"There was a problem deleting your expense.\");}}}const BudgetPage=()=>{const{budget,expenses}=useLoaderData();return/*#__PURE__*/_jsxs(\"div\",{className:\"grid-lg\",style:{\"--accent\":budget.color},children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"h2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"accent\",children:budget.name}),\" Overview\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-lg\",children:[/*#__PURE__*/_jsx(BudgetItem,{budget:budget,showDelete:true}),/*#__PURE__*/_jsx(AddExpenseForm,{budgets:[budget]})]}),expenses&&expenses.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid-md\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"accent\",children:budget.name}),\" Expenses\"]}),/*#__PURE__*/_jsx(Table,{expenses:expenses,showBudget:false})]})]});};export default BudgetPage;","map":{"version":3,"names":["useLoaderData","toast","AddExpenseForm","BudgetItem","Table","createExpense","deleteItem","getAllMatchingItems","jsx","_jsx","jsxs","_jsxs","budgetLoader","_ref","params","budget","category","key","value","id","expenses","Error","budgetAction","_ref2","request","data","formData","_action","values","Object","fromEntries","name","newExpense","amount","newExpenseAmount","budgetId","newExpenseBudget","success","concat","e","expenseId","BudgetPage","className","style","color","children","showDelete","budgets","length","showBudget"],"sources":["D:/PROGRAMING/js_kursai/REACT/budget/src/pages/BudgetPage.js"],"sourcesContent":["import { useLoaderData } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport AddExpenseForm from \"../components/AddExpenseForm\";\nimport BudgetItem from \"../components/BudgetItem\";\nimport Table from \"../components/Table\";\nimport { createExpense, deleteItem, getAllMatchingItems } from \"../helpers\";\n\nexport async function budgetLoader({ params }) {\n  const budget = await getAllMatchingItems({\n    category: \"budgets\",\n    key: \"id\",\n    value: params.id,\n  })[0];\n\n  const expenses = await getAllMatchingItems({\n    category: \"expenses\",\n    key: \"budgetId\",\n    value: params.id,\n  });\n\n  if (!budget) {\n    throw new Error(\"The budget you're trying to find doesn't exist\");\n  }\n\n  return { budget, expenses };\n}\n\n// action\nexport async function budgetAction({ request }) {\n  const data = await request.formData();\n  const { _action, ...values } = Object.fromEntries(data);\n\n  if (_action === \"createExpense\") {\n    try {\n      createExpense({\n        name: values.newExpense,\n        amount: values.newExpenseAmount,\n        budgetId: values.newExpenseBudget,\n      });\n      return toast.success(`Expense ${values.newExpense} created!`);\n    } catch (e) {\n      throw new Error(\"There was a problem creating your expense.\");\n    }\n  }\n\n  if (_action === \"deleteExpense\") {\n    try {\n      deleteItem({\n        key: \"expenses\",\n        id: values.expenseId,\n      });\n      return toast.success(\"Expense deleted!\");\n    } catch (e) {\n      throw new Error(\"There was a problem deleting your expense.\");\n    }\n  }\n}\n\nconst BudgetPage = () => {\n  const { budget, expenses } = useLoaderData();\n\n  return (\n    <div\n      className=\"grid-lg\"\n      style={{\n        \"--accent\": budget.color,\n      }}\n    >\n      <h1 className=\"h2\">\n        <span className=\"accent\">{budget.name}</span> Overview\n      </h1>\n      <div className=\"flex-lg\">\n        <BudgetItem budget={budget} showDelete={true} />\n        <AddExpenseForm budgets={[budget]} />\n      </div>\n      {expenses && expenses.length > 0 && (\n        <div className=\"grid-md\">\n          <h2>\n            <span className=\"accent\">{budget.name}</span> Expenses\n          </h2>\n          <Table expenses={expenses} showBudget={false} />\n        </div>\n      )}\n    </div>\n  );\n};\nexport default BudgetPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}